# BUDGET MANAGER V2 ‚Äî SP√âCIFICATION FONCTIONNELLE COMPL√àTE

## üéØ OBJECTIF

Application web de gestion budg√©taire personnelle bas√©e sur la **m√©thode des enveloppes**, permettant de r√©partir ses revenus en 4 cat√©gories et de suivre sa sant√© financi√®re sur 12 mois, avec un module Patrimoine pour le suivi de l'√©pargne.

---

## üìã INFORMATIONS PROJET

- **Nom** : Budget Manager v2
- **Repo GitHub** : `smalldjo-coder/Budget-Manager-v2`
- **Dossier local** : `/Users/djoe/Documents/DEVELOPPEUR/budget-manager-v2`
- **URL production** : `https://budget-manager-v2.vercel.app`
- **Stack** : React 18, Recharts, Tailwind CSS, Vite
- **D√©ploiement** : Vercel (auto-deploy sur push branche `main`)

---

## üèóÔ∏è ARCHITECTURE DES VUES

L'application comporte **3 vues** accessibles via des onglets :

| Onglet | Ic√¥ne | Description |
|--------|-------|-------------|
| **Saisie** | üìù | Saisie/consultation des donn√©es mensuelles + import/export |
| **Dashboard** | üìä | Graphiques, jauges, calendrier de sant√©, levier |
| **Patrimoine** | üê∑ (PiggyBank) | Suivi √©pargne : LEP, Livret A, PEA avec objectifs dynamiques |

---

## üìä STRUCTURE BUDG√âTAIRE

### 1. REVENUS (Entr√©es)

| Cat√©gorie | Description |
|-----------|-------------|
| **Revenus d'activit√©** | Salaires, freelance, activit√© principale |
| **Revenus sociaux** | Aides, allocations, solidarit√© |
| **Int√©r√™ts / Avantages** | Int√©r√™ts bancaires, remboursements, primes, avantages |
| **Flux internes** | Virements entre comptes propres (NON compt√©s dans le CA) |

**CA (Chiffre d'Affaires)** = Activit√© + Sociaux + Int√©r√™ts ‚Äî les flux internes sont **exclus** du CA.

### 2. SORTIES (4 Enveloppes)

| Enveloppe | Sous-cat√©gories | Couleur |
|-----------|-----------------|---------|
| **BESOINS** | Charges fixes, Charges variables, N√©cessit√© | Gris/Noir |
| **DETTES** | Cr√©dit immobilier, Cr√©dit auto, Autres dettes | Bleu |
| **√âPARGNE** | Livret (LEP), Placement (PEA), Investissements | Orange |
| **ENVIES** | Fourmilles (petites d√©penses r√©currentes), Occasionnel | Rouge |

### 3. SOLDE

**Solde Final** = Total Revenus ‚àí Total Sorties
- Affich√© en **vert** si positif
- Affich√© en **rouge** si n√©gatif

---

## üìù VUE SAISIE (D√©tail)

### Navigation mensuelle
- **12 boutons** correspondant aux mois (Jan ‚Üí D√©c)
- Le mois actif est mis en surbrillance
- Cliquer sur un mois affiche ses donn√©es

### Sections de saisie
Chaque section affiche ses sous-cat√©gories avec un champ de saisie num√©rique et un total :

1. **REVENUS** : Activit√©, Sociaux, Int√©r√™ts, Flux internes ‚Üí Total Revenus + CA
2. **BESOINS** : Fixes, Variables, N√©cessit√© ‚Üí Total Besoins
3. **DETTES** : Cr√©dit immo, Cr√©dit auto, Autres ‚Üí Total Dettes
4. **√âPARGNE** : Livret, Placement, Invest ‚Üí Total √âpargne
5. **ENVIES** : Fourmilles, Occasionnel ‚Üí Total Envies

Chaque section affiche un **indicateur de sant√©** sous le total (voir section Indicateurs ci-dessous).

### Boutons d'action
- **üì• Import CSV** : Import format natif (colonnes pr√©d√©finies)
- **üì± Import iCompta** : Import CSV export√© depuis iCompta 6
- **üì• Import Livrets** : Import CSV des comptes d'√©pargne depuis iCompta 6
- **üì§ Export CSV** : Sauvegarde des donn√©es au format CSV

### Stats d'import
Apr√®s un import, afficher le nombre de transactions mapp√©es et le total import√©.

---

## üì± IMPORT iCompta ‚Äî MAPPING DES CAT√âGORIES

### Format du CSV iCompta
- **S√©parateur** : point-virgule (;)
- **28 colonnes** avec headers
- **Colonne cl√© "Compte"** (index 0) : contient la hi√©rarchie de cat√©gories avec emojis
- **Colonne "Date de valeur"** (index 4) : format JJ/MM/AAAA
- **Colonne "Montant"** (index 7) : nombre avec point d√©cimal, peut √™tre vide

### R√®gles de mapping (bas√©es sur la colonne "Compte")

```
Si contient "ENTR√âES" ET "ACTIVIT√â"       ‚Üí revenus.activite
Si contient "ENTR√âES" ET "SOCIALES"        ‚Üí revenus.sociaux
Si contient "ENTR√âES" ET ("INT√âR√äT" OU "REMBOURSEMENT" OU "Primes") ‚Üí revenus.interets
Si contient "SORTIES" ET "BESOIN" ET "Fixes"      ‚Üí besoins.fixes
Si contient "SORTIES" ET "BESOIN" ET "Variables"   ‚Üí besoins.variables
Si contient "SORTIES" ET "BESOIN" ET "N√©cessit√©"   ‚Üí besoins.necessite
Si contient "SORTIES" ET "DETTE"                    ‚Üí dettes.autres
Si contient "SORTIES" ET "EPARGNE" ET ("Livret" OU "LEP") ‚Üí epargne.livret
Si contient "SORTIES" ET "EPARGNE" ET ("Placement" OU "PEA") ‚Üí epargne.placement
Si contient "SORTIES" ET "ENVIE" ET ("FOURMILLES" OU "FOURMILLE") ‚Üí envies.fourmilles
Si contient "SORTIES" ET "ENVIE" ET ("OCCASIONNEL" OU "OCCASSIONNEL") ‚Üí envies.occasionnel
Si contient "SORTIES" ET "ENVIE" (fallback) ‚Üí envies.occasionnel
```

### D√©tection des flux internes
Les virements entre comptes propres (ex: compte courant ‚Üí LEP) doivent √™tre d√©tect√©s et class√©s en **flux internes**, exclus du CA.

### Gestion des cas sp√©ciaux
- Ignorer les lignes o√π le montant est vide
- Filtrer uniquement l'ann√©e s√©lectionn√©e (2025, 2026)
- G√©rer les lignes multilignes (commentaires avec guillemets et \n)
- Les montants sont en valeur absolue (les sorties sont positives)
- "Fourmilles" doit √™tre test√© AVANT le fallback occasionnel
- G√©rer les deux orthographes : "Occasionnel" et "Occassionnel"

---

## üì± IMPORT LIVRETS ‚Äî FORMAT ET MAPPING

### Format du CSV Livrets (iCompta)
- M√™me structure que le CSV comptes courants
- Colonne "Compte" (index 0) contient le nom du livret
- Colonne "Date de valeur" (index 4) : format JJ/MM/AAAA
- Colonne "Montant" (index 7) : positif = versement/int√©r√™ts, n√©gatif = retrait

### Mapping des livrets

```
Si contient "LEP" ou "Livret √âpargne"     ‚Üí livret "lep"
Si contient "Livret A"                     ‚Üí livret "livretA"
Si contient "PEA" ou "Plan √âpargne"        ‚Üí livret "pea"
```

### Types d'op√©rations sur livrets

```
Si contient "Int√©r√™t" ou "INT."            ‚Üí type "interets"
Si contient "Virement" ou "Transfert" :
  - Montant positif                        ‚Üí type "versement"
  - Montant n√©gatif                        ‚Üí type "retrait"
```

### Calcul des soldes progressifs
Pour chaque livret, de janvier √† d√©cembre :
- Mois 1 : `soldeFin = soldeDebut + versements - retraits + interets`
- Mois suivants : `soldeDebut = soldeFin du mois pr√©c√©dent`

---

## üìä VUE DASHBOARD (D√©tail)

### 1. Graphiques (Recharts)

| Graphique | Type | Description |
|-----------|------|-------------|
| **R√©partition mensuelle** | Pie Chart | Parts de chaque enveloppe pour le mois s√©lectionn√© |
| **√âvolution annuelle** | Line Chart | Courbes des 4 enveloppes sur 12 mois |
| **R√©partition empil√©e** | Bar Chart (stacked) | Barres empil√©es par mois |

### 2. Jauges de sant√© (3 jauges circulaires)

| Jauge | Calcul | Seuils |
|-------|--------|--------|
| **Dettes** | Total Dettes / Revenus Activit√© √ó 100 | ‚â§10% vert, 11-20% jaune, >20% rouge |
| **√âpargne** | Total √âpargne / CA √ó 100 | <5% rouge, 5-20% vert, >20% orange |
| **Envies** | Total Envies / CA √ó 100 | <10% rouge, 10-30% vert, >30% rouge |

### 3. Calendrier de sant√© budg√©taire
- **12 pastilles** (une par mois) avec couleur selon le score de sant√©
- Cliquer sur un mois **change le mois s√©lectionn√©** (reste sur Dashboard, ne redirige PAS vers Saisie)
- Couleurs : vert (bon), jaune (moyen), rouge (mauvais)

### 4. Objectifs Patrimoine
- Affichage des objectifs LEP et PEA avec barres de progression
- Pourcentage atteint

### 5. Levier √âpargne/Envies
- **Curseur (slider)** permettant d'ajuster la r√©partition entre √âpargne et Envies
- Indicateurs visuels montrant l'impact du r√©glage
- Met √† jour les graphiques en temps r√©el

---

## üìà INDICATEURS DE SANT√â NUANC√âS

### Seuils et zones color√©es

#### BESOINS (cible : ‚â§50% du CA)
| Plage | Couleur | Label | Conseil |
|-------|---------|-------|---------|
| 0-50% | üü¢ Vert | Budget √âquilibr√© | "Permet de vivre selon ses envies et d'√©pargner" |
| 51-75% | üü° Jaune | Budget Raisonnable | "Contraint √† r√©duire envies, limite l'√©pargne possible" |
| 76-100% | üî¥ Rouge | Budget Instable | "Favorise soucis financiers et endettement" |

#### DETTES (cible : ‚â§10% des revenus d'activit√©)
| Plage | Couleur | Label | Conseil |
|-------|---------|-------|---------|
| 0-10% | üü¢ Vert | C'est l'id√©al | "Plus vous vous rapprochez de z√©ro, mieux c'est" |
| 11-20% | üü° Jaune | Restriction | "Acc√©l√©rez le remboursement" |
| 21%+ | üî¥ Rouge | Stressant | "Priorit√© au d√©sendettement" |

#### √âPARGNE (cible : 5-20% du CA)
| Plage | Couleur | Label | Conseil |
|-------|---------|-------|---------|
| 0-4% | üî¥ Rouge | Insuffisant | "Priorisez le fonds d'urgence" |
| 5-20% | üü¢ Vert | Optimal | "Potentiel maximis√© !" |
| 21%+ | üü† Orange | Attention | "V√©rifiez que ce n'est pas au d√©triment des envies" |

#### ENVIES (cible : 10-30% du CA)
| Plage | Couleur | Label | Conseil |
|-------|---------|-------|---------|
| 0-9% | üî¥ Rouge | Frustration | "Autorisez-vous plus de plaisirs" |
| 10-30% | üü¢ Vert | √âquilibr√© | "Profitez sans culpabiliser !" |
| 31%+ | üî¥ Rouge | Surconsommation | "Limite votre √©pargne" |

### Affichage des indicateurs
- Barre color√©e horizontale avec la zone active
- Pourcentage affich√©
- Label de la zone (ex: "Raisonnable")
- Conseil contextuel en dessous
- Pr√©sents √† la fois dans la vue **Saisie** (sous chaque section) et dans le **Dashboard** (jauges)

### Score de sant√© global (0-100)
```
Score = 100
- Si Besoins > 75% du CA : -30 points
- Si Besoins > 50% du CA : -15 points
- Si Dettes > 20% : -25 points
- Si Dettes > 10% : -10 points
- Si √âpargne < 5% : -20 points
- Si √âpargne > 20% : -5 points
- Si Envies < 10% : -15 points
- Si Envies > 30% : -20 points

R√©sultat :
80-100 : Excellent (vert)
60-79 : Bon (jaune-vert)
40-59 : √Ä am√©liorer (jaune)
0-39 : Critique (rouge)
```

---

## üê∑ VUE PATRIMOINE (D√©tail)

### 1. Header ‚Äî Solde total
- Titre "Patrimoine √âpargne Total"
- **Montant total** (somme LEP + Livret A + PEA) en grand et vert
- Objectif total et pourcentage atteint
- **√âvolution du mois** : diff√©rence avec le mois pr√©c√©dent (vert si +, rouge si -)

### 2. Cartes Livrets (3 cartes)

| Livret | Cat√©gorie | Objectif dynamique |
|--------|-----------|-------------------|
| **LEP** (Boursorama) | √âpargne de pr√©caution | 6 mois de charges (besoins fixes + variables + n√©cessit√©) |
| **Livret A** | √âpargne de pr√©caution | 3 mois de charges |
| **PEA** | Investissements long terme | 12 mois de CA (revenus d'activit√©) |

Chaque carte affiche :
- Nom du livret
- Solde actuel
- √âvolution du mois (+/- par rapport au mois pr√©c√©dent)
- Barre de progression vers l'objectif
- Pourcentage atteint
- D√©tail : versements, retraits, int√©r√™ts du mois

### 3. Objectifs dynamiques
Les objectifs sont calcul√©s automatiquement √† partir des donn√©es r√©elles :
- Prendre tous les mois qui ont des donn√©es (totalRevenus > 0)
- Calculer la **moyenne mensuelle** des besoins et revenus
- Multiplier par le nombre de mois correspondant (6, 3, ou 12)
- Si aucune donn√©e : valeurs par d√©faut (LEP 7812‚Ç¨, Livret A 3000‚Ç¨, PEA 10000‚Ç¨)

### 4. Graphique d'√©volution
- **Line Chart** ou **Area Chart** montrant l'√©volution des 3 livrets + total sur 12 mois
- Donn√©es : patrimoineEvolutionData avec pour chaque mois les soldeFin de chaque livret

---

## üé® DESIGN & UX

### Th√®me
- **Dark mode** avec fond sombre
- Interface mobile-first, responsive
- Couleurs coh√©rentes avec les enveloppes

### Navigation
- Onglets en haut (Saisie / Dashboard / Patrimoine)
- Navigation mois par boutons ou calendrier
- Transitions fluides entre les vues

### Page d'accueil
- √âcran de bienvenue "Bienvenue dans Budget Manager"
- Bouton "Suivant" pour acc√©der √† l'app
- Logo/ic√¥ne de l'application

---

## ‚öôÔ∏è CONFIGURATION GIT & D√âPLOIEMENT

Pour que Claude Code puisse push directement sur Vercel :

```bash
git remote set-url origin https://smalldjo-coder:TOKEN@github.com/smalldjo-coder/Budget-Manager-v2.git
```

Le token GitHub doit √™tre configur√© pour permettre le push automatique. Vercel d√©ploie automatiquement √† chaque push sur `main`.

---

## üìã CHECKLIST DE V√âRIFICATION

Utilise cette checklist pour v√©rifier que toutes les fonctionnalit√©s sont pr√©sentes :

### Vue Saisie
- [ ] Navigation 12 mois fonctionnelle
- [ ] Section Revenus (4 sous-cat√©gories + CA calcul√© hors flux internes)
- [ ] Section Besoins (Fixes, Variables, N√©cessit√©)
- [ ] Section Dettes (Cr√©dit immo, Cr√©dit auto, Autres)
- [ ] Section √âpargne (Livret, Placement, Invest)
- [ ] Section Envies (Fourmilles, Occasionnel ‚Äî s√©par√©es correctement)
- [ ] Solde Final avec couleur conditionnelle
- [ ] Indicateurs de sant√© sous chaque section
- [ ] Bouton Import CSV natif
- [ ] Bouton Import iCompta (mapping correct)
- [ ] Bouton Import Livrets
- [ ] Bouton Export CSV
- [ ] Stats d'import affich√©es

### Vue Dashboard
- [ ] Pie Chart r√©partition mensuelle
- [ ] Line Chart √©volution annuelle
- [ ] Bar Chart empil√©
- [ ] 3 Jauges circulaires (Dettes, √âpargne, Envies)
- [ ] Calendrier sant√© 12 mois (clic = change mois, reste sur Dashboard)
- [ ] Objectifs Patrimoine avec progression
- [ ] Levier √âpargne/Envies ajustable
- [ ] Score de sant√© global

### Vue Patrimoine
- [ ] Header avec solde total + √©volution
- [ ] Carte LEP avec solde, objectif, progression
- [ ] Carte Livret A avec solde, objectif, progression
- [ ] Carte PEA avec solde, objectif, progression
- [ ] Objectifs calcul√©s dynamiquement
- [ ] Graphique d'√©volution sur 12 mois

### Import iCompta
- [ ] Parse correctement le CSV point-virgule 28 colonnes
- [ ] Mapping cat√©gories par colonne "Compte" avec emojis
- [ ] D√©tection flux internes
- [ ] Fourmilles s√©par√© d'Occasionnel
- [ ] Gestion lignes multilignes
- [ ] Gestion montants vides
- [ ] Filtrage par ann√©e

### Import Livrets
- [ ] Parse CSV livrets
- [ ] Reconnaissance LEP, Livret A, PEA
- [ ] Classification versements/retraits/int√©r√™ts
- [ ] Calcul soldes progressifs mois par mois
